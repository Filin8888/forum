<!-- –î–µ—Ç–∞–ª—ñ –ø–æ—Å—Ç–∞ + –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ -->
{% extends "base.html" %}
{% block title %}{{ post.title }}{% endblock %}
{% block content %}
<article class="post-card">
  <h2>{{ post.title }}</h2>
  <p class="meta">–ê–≤—Ç–æ—Ä: {{ post.author.username }} ¬∑ {{ post.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
  <div class="body">{{ post.content }}</div>

  <div class="post-actions">
    {% if current_user.is_authenticated %}
      <form method="post" action="{{ url_for('main.like_post', post_id=post.id) }}">
        <button type="submit" class="btn-ghoust">üëç {{ post.likes|length }}</button>
      </form>
      {% if current_user.role in ['admin','moderator'] or current_user.id == post.author_id %}
        <a href="{{ url_for('main.edit_post', post_id=post.id) }}" class="btn">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
        <form method="post" action="{{ url_for('main.delete_post', post_id=post.id) }}" style="display:inline;">
          <button class="btn-danger" type="submit">–í–∏–¥–∞–ª–∏—Ç–∏</button>
        </form>
      {% endif %}
    {% endif %}
  </div>
</article>

<section class="comments">
    <!-- –§–æ—Ä–º–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—è -->
  <div class="comment-form">
    <form method="post" action="{{ url_for('main.add_comment', post_id=post.id) }}">
      <textarea name="content" rows="3" placeholder="–ù–∞–ø–∏—à–∏ —Å–≤—ñ–π –∫–æ–º–µ–Ω—Ç–∞—Ä..."></textarea>
      <button type="submit">–î–æ–¥–∞—Ç–∏</button>
    </form>
  </div>

  <!-- –°–ø–∏—Å–æ–∫ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ -->
  <div class="comment-list">
    <h4>–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ:</h4>
    {% for comment in post.comments %}
      <div class="comment">
        <span class="author">{{ comment.user.username }}</span>
        <span class="date">{{ comment.created_at.strftime("%d.%m.%Y %H:%M") }}</span>
        <div class="content">{{ comment.content }}</div>
      </div>
    {% else %}
      <p class="text-muted">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤.</p>
    {% endfor %}
  </div>


</section>
{% endblock %}
